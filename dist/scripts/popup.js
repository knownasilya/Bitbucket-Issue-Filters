"use strict";function displayCurrentRepo(a){var b=document.querySelector("#repo-name"),c=document.querySelector("#filter"),d=document.createElement("span"),e=document.querySelector("#add-filter");b.textContent=a.pageName,d.id="filter-param",d.textContent=a.params,a.label=c.value,insertAfter(c,d),e.addEventListener("click",addFilter(a))}function addFilter(a){return function(){var b="bb-filters:"+a.pageName;chrome.storage.sync.get(b,function(c){var d=c[b];d instanceof Array||(d=[]),d.push({label:a.label,params:a.params}),c[b]=d,chrome.storage.sync.set(c,function(){message("Filter Saved")})})}}function insertAfter(a,b){a.parentNode.insertBefore(b,a.nextSibling)}function paramsToObj(a){var b,c,d,e,f={};e=a.split("&");for(var g=0;g<e.length;g++)b=e[g].split("="),b[0]&&(b.length<2&&b.push(""),c=decodeURIComponent(b[0]),d=decodeURIComponent(b[1]),f[c]&&d?f[c]+=","+d:f[c]=d);return f}chrome.tabs.query({active:!0},function(a){var b,c,d=0;if(a&&a.length)for(d in a)-1!==a[d].url.indexOf("bitbucket.org")&&(console.dir(a[0]),b=a[d],c=b&&b.url?b.url.split("?")[1]:"",chrome.tabs.sendMessage(b.id,"getPageData",function(a){a&&(this.params&&(a.params=this.params),displayCurrentRepo(a))}.bind({params:c})))});